(function($) {
    jQuery.fn.intoViewport = function(options) {
        options = $.extend({
                               // Configuration
                               // Add whatever options animate schould get by default
                               duration:  200,
                               easing: "swing"
                           }, options || {});
        return this.each(function(){
            // scroll to certain destination:
            function scrollX(left) {
                $("html,body").stop().animate({ scrollLeft: left}, options );
            }
            function scrollY(top) {
                $("html,body").stop().animate({ scrollTop: top}, options );
            }
            var
                margin = 200,

                screen_y = $(document).scrollTop() || $(window).scrollTop(),
                window_height = $(window).height(),
                element_top = $(this).offset().top,
                element_height = $(this).outerHeight(),

                screen_x = $(document).scrollLeft() || $(window).scrollLeft(),
                window_width = $(window).width(),
                element_left = $(this).offset().left,
                element_width = $(this).outerWidth();

            // scroll up
            if (screen_y > element_top) {
                scrollY(element_top - margin);
            }
            // scroll down
            else if (screen_y != element_top && element_top+element_height > screen_y+window_height) {
                scrollY(element_top + margin + Math.min(element_height - window_height, 0));
            }

            // scroll left
            if (screen_x > element_left) {
                scrollX(element_left - margin);
            }
            // scroll right
            else if (screen_x != element_left && element_left+element_width > screen_x+window_width) {
                scrollX(element_left + margin + Math.min(element_width-window_width, 0));
            }
        });
    };
})(jQuery); //compatibility